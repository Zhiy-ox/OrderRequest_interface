<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Create SharePoint Item Demo</title>
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
  />
</head>
<body class="bg-light">
  <div class="container py-5">
    <div class="row">
      <div class="col-md-8 offset-md-2 col-lg-6 offset-lg-3">
        <div class="card shadow">
          <div class="card-body">
            <h3 class="card-title mb-4 text-center">Create SharePoint Item</h3>
            <form id="itemForm">
              <!-- Materials_x002f_equipmentName -->
              <div class="mb-3">
                <label for="Materials_x002f_equipmentName" class="form-label">
                  Materials_x002f_equipmentName
                </label>
                <input
                  type="text"
                  class="form-control"
                  id="Materials_x002f_equipmentName"
                  placeholder="e.g., E7, BL006, etc."
                  required
                />
              </div>

              <!-- Quantity -->
              <div class="mb-3">
                <label for="Quantity" class="form-label">Quantity</label>
                <input
                  type="number"
                  class="form-control"
                  id="Quantity"
                  placeholder="e.g., 10"
                  required
                />
              </div>

              <!-- Unit -->
              <div class="mb-3">
                <label for="Unit" class="form-label">Unit</label>
                <input
                  type="text"
                  class="form-control"
                  id="Unit"
                  placeholder="e.g., g, pcs, etc."
                />
              </div>

              <!-- Proposal -->
              <div class="mb-3">
                <label for="Proposal" class="form-label">Proposal</label>
                <textarea
                  class="form-control"
                  id="Proposal"
                  rows="3"
                  placeholder="Short justification or proposal"
                ></textarea>
              </div>

              <!-- LinkofMaterials_x002f_Equipment -->
              <div class="mb-3">
                <label for="LinkofMaterials_x002f_Equipment" class="form-label">
                  LinkofMaterials_x002f_Equipment
                </label>
                <input
                  type="text"
                  class="form-control"
                  id="LinkofMaterials_x002f_Equipment"
                  placeholder="e.g., https://supplier.com/product"
                />
              </div>

              <!-- TheOrderTrackingURL -->
              <div class="mb-3">
                <label for="TheOrderTrackingURL" class="form-label">
                  TheOrderTrackingURL
                </label>
                <input
                  type="text"
                  class="form-control"
                  id="TheOrderTrackingURL"
                  placeholder="e.g., https://tracking.com/order/123"
                />
              </div>

              <!-- OrderSumbittedTime -->
              <div class="mb-3">
                <label for="OrderSumbittedTime" class="form-label">
                  OrderSumbittedTime
                </label>
                <input
                  type="datetime-local"
                  class="form-control"
                  id="OrderSumbittedTime"
                />
                <!-- Alternatively, type="text" if you prefer raw ISO8601 string input -->
              </div>

              <button type="submit" class="btn btn-primary w-100">Submit</button>
            </form>

            <div id="responseMessage" class="mt-3" style="min-height: 1.5em;"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS (optional) -->
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
  ></script>

  <script>
    // Replace with your actual Power Automate endpoint (the Flow URL)
    const CREATE_ITEM_FLOW_URL = "https://prod-138.westeurope.logic.azure.com:443/workflows/877185416c504d72bb3b358ce1ed3b99/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=Tt5rReEuy-aWUDpDu6k0KqH0J2_jv4HQ4CvgKyocnuM";

    const itemForm = document.getElementById("itemForm");
    itemForm.addEventListener("submit", async (event) => {
      event.preventDefault();

      // Collect form data into a JSON object
      const formData = {
        Materials_x002f_equipmentName:
          document.getElementById("Materials_x002f_equipmentName").value.trim(),
        Quantity: parseInt(document.getElementById("Quantity").value, 10),
        Unit: document.getElementById("Unit").value.trim(),
        Proposal: document.getElementById("Proposal").value.trim(),
        LinkofMaterials_x002f_Equipment:
          document.getElementById("LinkofMaterials_x002f_Equipment").value.trim(),
        TheOrderTrackingURL:
          document.getElementById("TheOrderTrackingURL").value.trim(),
        OrderSumbittedTime:
          document.getElementById("OrderSumbittedTime").value // maybe convert to ISO if needed
      };

      try {
        const response = await fetch(CREATE_ITEM_FLOW_URL, {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify(formData)
        });

        if (response.ok) {
          document.getElementById("responseMessage").textContent =
            "Item successfully created in SharePoint.";
          itemForm.reset();
        } else {
          document.getElementById("responseMessage").textContent =
            "Error creating item.";
        }
      } catch (error) {
        console.error("Error:", error);
        document.getElementById("responseMessage").textContent =
          "An unexpected error occurred. Please try again.";
      }
    });
  </script>
</body>
</html>
